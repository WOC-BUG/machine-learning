# 模型评估与选择

## 四、测试集上的性能在多大程度上保证真实性能

### 比较检验

#### 问题
1. 测试集上的性能与真实泛化性能未必相同
2. 不同的多个测试集反应出来的性能不同
3. 机器学习算法具有一定的随机性，同一测试集多次运行的结果可能不同


#### 一个测试集一种算法

**常用的离散型随机变量**
1. 0-1分布
    随机变量X只有两个可能的取值0和1，其概率分布为：
    P(X=$x_i$) = $p^{x_i}(1-p)^{1-x_i}$,$x_i$=0,1,则称X服从0-1分布。
2. 二项分布B(n,P)
    设事件A在任意一次实验中出现的概率均为p(0 < p < 1),X表示n重伯努利实验中事件A发生的次数，则X所有可能的取值为0,1,2,...,n，相应的概率为：P(X=k)=$C^k_np^k(1-p)^{n-k}$,k=0,1,2,...,n。

e.g.
假设一共10个样本，每个样本出错的概率为0.3,则：
错0个样本的可能性为P(X=0)=$C^0_{10}(0.3)^0(0.7)^{10}$,
错1个样本的可能性为P(X=1)=$C^1_{10}(0.3)^1(0.7)^{9}$,
错2个样本的可能性为P(X=2)=$C^2_{10}(0.3)^2(0.7)^{8}$,
...
错10个样本的可能性为P(X=10)=$C^{10}_{10}(0.3)^{10}(0.7)^{0}$.
画出图像可以看出离假设是否合理。

**二项分布示意图：**
![avater](\二项分布示意图.png)
可使用“二项检验”来对“e<=0.3”(泛化错误率是否小于等于0.3)的假设进行检验。在1-α的概率内所能观测到的最大错误率计算公式如下（1-α反应了结论的置信度，即图中非阴影部分）：
**置信度：**
![avatar](\confidence.png)
其中s.t.表示左边式子在右边条件满足时成立

代码实例：https://www.bilibili.com/video/av79015715?p=29



#### 多个测试集一种算法
**t检验**
多次留出法/交叉验证法进行多次训练/测试会得到多个测试错误率，可使用t检验。
假设有k个测试错误率：$e_1,e_2,...,e_k$，则：
**平均错误率**$μ=\frac{1}{k}\sum^k_{i=1}e_i$
**方差**$σ^2=\frac{1}{k-1}\sum^k_{i=1}(e_i-μ)^2$
k个错误率可看作泛化错误率$e_0$的独立采样，则$τ_t=\frac{\sqrt{k}(μ-e_0)}{σ}$服从自由度为k-1的t分布：
![avatar](\t分布.png)



#### 多个测试集两种算法
**交叉验证t检验**

#### 一个测试集两种算法
**McNemar检验**

#### 多个测试集多种算法
**Friedman检验与Nemenyi后续检验**